<%- include("partials/header.ejs") %>

<main>
  <div class="entries-flex">
    <div><a href="/add-entry">Add New Entry</a></div>

    <div>
      <form action="/sort" method="POST">
        <label for="sortBy">Sort by:</label>
        <select name="sortBy" id="sortBy" onclick="submitIfOptionChosen(this)">
          <option value="" disabled selected>Select sorting</option>
          <option value="reviews.date_created DESC">Newest</option>
          <option value="reviews.date_created ASC">Oldest</option>
          <option value="books.title ASC">Title (A-Z)</option>
          <option value="books.title DESC">Title (Z-A)</option>
        </select>
      </form>
    </div>

    <% for (let entry of Entries) { %>
    <div class="entry-grid">
      <img
        src="<%= entry.book_cover %>"
        alt="book cover for <%= entry.title %>"
      />
      <div class="entry-text-container">
        <div class="entry-title">
          <h3>
            <a
              href="<%= entry.ol_link %>"
              target="_blank"
              rel="noopener noreferrer"
              ><%= entry.title %></a
            >
          </h3>
          <p>by <%= entry.author %></p>
        </div>
        <p>Rating: <%= entry.rating %> / 5</p>
        <p>Review: <%= entry.review %></p>
        <div class="entry-tidbits">
          <p>
            Date Created: <% const formattedDate = new
            Date(entry.date_created).toLocaleDateString(); %> <%= formattedDate
            %>
          </p>
          <div class="entry-tidbits-buttons">
            <a href="/edit/<%= entry.review_id %>">Edit</a>
            <form method="POST">
              <a
                href="/delete/<%= entry.review_id %>"
                onclick="return confirm('Are you sure you want to delete this entry?')"
                >Delete</a
              >
            </form>
          </div>
        </div>
      </div>
    </div>
    <% } %>
  </div>
</main>

<%- include("partials/footer.ejs") %>
